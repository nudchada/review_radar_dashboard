<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QC Audit System</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600&display=swap" rel="stylesheet">

    <style>
        /* Reuse Base Settings from Dashboard */
        html, body { 
            background-color: #f0f2f5; 
            font-family: 'Sarabun', sans-serif; 
            height: 100%; 
            overflow: hidden; 
            color: #2c3e50; 
        }

        .dashboard-container {
            height: 100vh;
            display: flex;
            flex-direction: column;
            padding: 1rem;
        }

        .header-section { flex-shrink: 0; }
        .content-area { 
            flex-grow: 1; 
            min-height: 0; 
            margin-top: 15px; 
            overflow: hidden; 
            border-radius: 16px;
            background: white;
            box-shadow: 0 4px 12px rgba(0,0,0,0.04);
            display: flex;
            flex-direction: column;
        }

        /* Table Styles */
        .col-scrollable { 
            overflow-y: auto; 
            flex-grow: 1;
        }
        .col-scrollable::-webkit-scrollbar { width: 6px; }
        .col-scrollable::-webkit-scrollbar-track { background: transparent; }
        .col-scrollable::-webkit-scrollbar-thumb { background: #b0bec5; border-radius: 10px; }

        .table-custom { font-size: 0.95rem; }
        .table-custom thead th {
            background-color: #e3f2fd; /* ฟ้าอ่อน สำหรับ QC Theme */
            color: #1565c0;
            font-weight: 600;
            border-bottom: 2px solid #bbdefb;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        .table-custom tbody td { vertical-align: middle; border-bottom: 1px solid #f0f0f0; padding: 12px 15px; }
        
        /* Status Badges */
        .badge-status {
            padding: 5px 10px; border-radius: 50px; font-size: 0.8em; font-weight: 600; text-transform: uppercase;
        }
        .status-pending { background-color: #fff3e0; color: #ef6c00; border: 1px solid #ffe0b2; }
        .status-reviewed { background-color: #e8f5e9; color: #2e7d32; border: 1px solid #c8e6c9; }

        /* Confidence Bar */
        .conf-wrapper { width: 80px; height: 6px; background: #eee; border-radius: 3px; overflow: hidden; display: inline-block; vertical-align: middle; margin-right: 5px;}
        .conf-fill { height: 100%; background: #4caf50; }
        .conf-low { background: #ef5350; }
        .conf-mid { background: #ffa726; }

        /* Action Button */
        .btn-audit {
            background-color: white; border: 1px solid #2196f3; color: #1976d2;
            border-radius: 50px; padding: 4px 16px; font-size: 0.85rem; transition: all 0.2s;
        }
        .btn-audit:hover { background-color: #e3f2fd; }

        /* Logo Area */
        .logo-container {
            display: flex; align-items: center; background-color: white;
            padding: 6px 18px; border-radius: 50px; border: 1px solid #eaeaea;
            box-shadow: 0 2px 5px rgba(0,0,0,0.02);
        }
        
        .loading-overlay {
            position: absolute; top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(255,255,255,0.8); z-index: 1000;
            display: none; justify-content: center; align-items: center;
        }
    </style>
</head>
<body>

    <div class="container-fluid dashboard-container position-relative">
        
        <div class="header-section">
            <div class="d-flex justify-content-between align-items-center mb-3">
                <div class="d-flex align-items-center gap-3">
                    <div class="logo-container">
                        <img src="/static/logo.jpg" alt="logo" style="height: 40px;">
                    </div>
                    <div>
                        <h5 class="fw-bold text-dark mb-0">QC Audit System</h5>
                        <div class="text-muted small">Batch: <span class="fw-bold text-primary">Session #55</span></div>
                    </div>
                </div>
                <div>
                     <a href="/" class="btn btn-outline-secondary btn-sm rounded-pill px-3">
                        <i class="fas fa-arrow-left me-1"></i> Back to Dashboard
                    </a>
                </div>
            </div>

            <div class="d-flex gap-3 mb-2">
                <div class="bg-white px-3 py-2 rounded-4 border flex-fill d-flex justify-content-between align-items-center shadow-sm">
                    <span class="text-muted small">Total Items</span>
                    <span class="fw-bold fs-5" id="stat-total">-</span>
                </div>
                <div class="bg-white px-3 py-2 rounded-4 border flex-fill d-flex justify-content-between align-items-center shadow-sm">
                    <span class="text-muted small">Reviewed</span>
                    <span class="fw-bold fs-5 text-success" id="stat-reviewed">-</span>
                </div>
                <div class="bg-white px-3 py-2 rounded-4 border flex-fill d-flex justify-content-between align-items-center shadow-sm">
                    <span class="text-muted small">Remaining</span>
                    <span class="fw-bold fs-5 text-warning" id="stat-remaining">-</span>
                </div>
            </div>
        </div>

        <div class="content-area position-relative">
            <div id="loadingOverlay" class="loading-overlay">
                <div class="spinner-border text-primary" role="status"></div>
            </div>

            <div class="col-scrollable">
                <table class="table table-custom table-hover w-100 mb-0">
                    <thead>
                        <tr>
                            <th style="width: 5%">ID</th>
                            <th style="width: 40%">Review Content</th>
                            <th style="width: 10%">Aspect</th>
                            <th style="width: 15%">Prediction</th>
                            <th style="width: 15%">Confidence</th>
                            <th style="width: 10%">Status</th>
                            <th style="width: 5%">Action</th>
                        </tr>
                    </thead>
                    <tbody id="qcTableBody">
                        </tbody>
                </table>
            </div>
        </div>

    </div>

    <div class="modal fade" id="auditModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content border-0 shadow-lg rounded-4">
                <div class="modal-header border-bottom-0 pb-0">
                    <h5 class="modal-title fw-bold">Audit Review #<span id="modal-item-id"></span></h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="p-3 bg-light rounded-3 mb-3">
                        <small class="text-muted d-block mb-1">Review Content:</small>
                        <p class="mb-0 text-dark fw-medium" id="modal-review-text">...</p>
                    </div>

                    <div class="row g-3 mb-3">
                        <div class="col-6">
                            <label class="small text-muted">Aspect</label>
                            <input type="text" class="form-control" id="modal-aspect" readonly>
                        </div>
                        <div class="col-6">
                            <label class="small text-muted">AI Prediction</label>
                            <input type="text" class="form-control fw-bold" id="modal-ai-pred" readonly>
                        </div>
                    </div>

                    <hr class="text-muted opacity-25">

                    <h6 class="fw-bold mb-3">Human Verification</h6>
                    <div class="d-flex gap-2 justify-content-center">
                        <input type="radio" class="btn-check" name="humanSentiment" id="btn-pos" value="positive" autocomplete="off">
                        <label class="btn btn-outline-success rounded-pill px-4" for="btn-pos">Positive</label>

                        <input type="radio" class="btn-check" name="humanSentiment" id="btn-neu" value="neutral" autocomplete="off">
                        <label class="btn btn-outline-warning rounded-pill px-4" for="btn-neu">Neutral</label>

                        <input type="radio" class="btn-check" name="humanSentiment" id="btn-neg" value="negative" autocomplete="off">
                        <label class="btn btn-outline-danger rounded-pill px-4" for="btn-neg">Negative</label>
                    </div>
                </div>
                <div class="modal-footer border-top-0 pt-0">
                    <button type="button" class="btn btn-light rounded-pill px-4" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary rounded-pill px-4" onclick="submitAudit()">Confirm Result</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/static/js/qc.js"></script>
</body>
</html>
